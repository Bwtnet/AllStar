# !/bin/bash
#
#
CONFIGS=/etc/asterisk
function die {
        echo "Fatal error: $1"
        exit 255
}

function promptyn
{
        echo -n "$1 [y/N]? "
        read ANSWER
        if [ ! -z $ANSWER ]
        then
                if [ $ANSWER = Y ] || [ $ANSWER = y ]
                then
                        ANSWER=Y
                else
                        ANSWER=N
                fi
        else
                ANSWER=N
        fi
}

echo ""
echo "***** Activate Node *****"
echo ""
promptyn "Do you want to do this now"

if [ $ANSWER = N ]
then
        exit 0
fi

# Contents of iax.conf to be changed
#; register = 2153:089741@register.allstarlink.org       ; This must be changed to your node number, password
#
# Contents to be changed in rpt.conf
#;statpost_program = /usr/bin/wget,-q,--timeout=15,--tries=1,--output-document=/dev/null
#;statpost_url = http://stats.allstarlink.org/uhandler.php ; Status updates

sed -i 's/; register =/register =/g' /etc/asterisk/iax.conf

# Used the $ in place of the /
sed -i 's$;statpost_program = /usr/bin/wget$statpost_program = /usr/bin/wget$g' /etc/asterisk/rpt.conf
sed -i "0,/statpost_url/ s/;statpost_url /statpost_url/" /etc/asterisk/rpt.conf


